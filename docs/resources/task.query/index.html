<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>task.query - Converge</title>
    <meta name="generator" content="Hugo 0.16" />

    
    <meta name="description" content="TODO: punchy description">
    
    <link rel="canonical" href="http://converge.aster.is/resources/task.query/">
    
    <meta name="author" content="Converge">
    

    <meta property="og:url" content="http://converge.aster.is/resources/task.query/">
    <meta property="og:title" content="Converge">
    <meta property="og:image" content="http://converge.aster.is/images/logo.png">
    <meta name="apple-mobile-web-app-title" content="Converge">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="http://converge.aster.is/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="http://converge.aster.is/images/favicon.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('http://converge.aster.is/fonts/icon.eot?52m981');
        src: url('http://converge.aster.is/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
             url('http://converge.aster.is/fonts/icon.woff?52m981')
               format('woff'),
             url('http://converge.aster.is/fonts/icon.ttf?52m981')
               format('truetype'),
             url('http://converge.aster.is/fonts/icon.svg?52m981#icon')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="http://converge.aster.is/stylesheets/application.css">
    <link rel="stylesheet" href="http://converge.aster.is/stylesheets/temporary.css">
    <link rel="stylesheet" href="http://converge.aster.is/stylesheets/palettes.css">
    <link rel="stylesheet" href="http://converge.aster.is/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu%2bMono">
    <style>
      body, input {
        font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="http://converge.aster.is/javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-indigo palette-accent-teal">



	
	


<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        task.query
      </div>
    </div>

    
    <div class="button button-twitter" role="button" aria-label="Twitter">
       <a href="https://twitter.com/asteris_llc" title="@asteris_llc on Twitter" target="_blank" class="toggle-button icon icon-twitter"></a>
    </div>
    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/asteris-llc" title="@asteris-llc on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="https://github.com/asteris-llc/converge" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="http://converge.aster.is/images/logo.png">
        </div>
      
      <div class="name">
        <strong>Converge <span class="version">0.3.0</span></strong>
        
          <br>
          asteris-llc/converge
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            <a href="https://github.com/asteris-llc/converge/archive/master.zip" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="https://github.com/asteris-llc/converge/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      

      <div class="toc">
        
        <ul>
          




<li>
    



<a  title="Converge" href="http://converge.aster.is/">
  
  Converge
</a>



    
    <ul>
        
        
        



<a  title="Install" href="http://converge.aster.is/install/">
  
  Install
</a>



        
        
        



<a  title="Getting Started" href="http://converge.aster.is/getting-started/">
  
  Getting Started
</a>



        
        
        



<a  title="Module Organization" href="http://converge.aster.is/organization/">
  
  Module Organization
</a>



        
        
        



<a  title="Server" href="http://converge.aster.is/server/">
  
  Server
</a>



        
        
        



<a  title="Configuration" href="http://converge.aster.is/configuration/">
  
  Configuration
</a>



        
    </ul>
    
</li>



<li>
    



<a  title="License" href="http://converge.aster.is/license/">
  
  License
</a>



    
</li>



<li>
    



<a  title="Resource Reference" href="http://converge.aster.is/resources/">
  
  Resource Reference
</a>



    
    <ul>
        
        
        



<a  title="docker.container" href="http://converge.aster.is/resources/docker-container/">
  
  docker.container
</a>



        
        
        



<a  title="docker.image" href="http://converge.aster.is/resources/docker-image/">
  
  docker.image
</a>



        
        
        



<a  title="file.content" href="http://converge.aster.is/resources/file-content/">
  
  file.content
</a>



        
        
        



<a  title="file.mode" href="http://converge.aster.is/resources/file-mode/">
  
  file.mode
</a>



        
        
        



<a  title="module" href="http://converge.aster.is/resources/module/">
  
  module
</a>



        
        
        



<a  title="param" href="http://converge.aster.is/resources/param/">
  
  param
</a>



        
        
        



<a  title="task" href="http://converge.aster.is/resources/task/">
  
  task
</a>



        
        
        



<a class="current" title="task.query" href="http://converge.aster.is/resources/task.query/">
  
  task.query
</a>


<ul id="scrollspy">
</ul>


        
    </ul>
    
</li>


        </ul>
        

        
        <hr>
        <span class="section">The author</span>
        
        <ul>
          
          <li>
            <a href="https://twitter.com/asteris_llc" target="_blank" title="@asteris_llc on Twitter">
              @asteris_llc on Twitter
            </a>
          </li>
          

          
          <li>
            <a href="https://github.com/asteris-llc" target="_blank" title="@asteris-llc on GitHub">
              @asteris-llc on GitHub
            </a>
          </li>
          
        </ul>
        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>task.query </h1>

			

<p>Task.query allows you to run arbitrary shell commands on your system and store
the output without taking any actions that would have permanent effects.  It
overlaps significantly with the Task module, differing in the use of a field,
<code>query</code> in place of <code>check</code> and <code>apply</code>, and in the fact that there is never an
application phase.</p>

<h2 id="example">Example</h2>

<pre><code class="language-hcl">task.query &quot;hostname&quot; {
  query = &quot;hostname&quot;
}

file.content &quot;hostname data&quot; {
  destination = &quot;hostname.txt&quot;
  content     = &quot;{{lookup `task.query.hostname.Status.Stdout`}}&quot;
}

</code></pre>

<h2 id="parameters">Parameters</h2>

<ul>
<li><code>interpreter</code> (string)</li>
</ul>

<p>the shell interpreter that will be used for your scripts. <code>/bin/sh</code> is
used by default.</p>

<ul>
<li><code>check_flags</code> (list of strings)</li>
</ul>

<p>flags to pass to the <code>interpreter</code> binary to check validity. For
<code>/bin/sh</code> this is <code>-n</code></p>

<ul>
<li><code>exec_flags</code> (list of strings)</li>
</ul>

<p>flags to pass to the interpreter at execution time</p>

<ul>
<li><code>query</code> (string)</li>
</ul>

<p>the script to run to query the system.  The output and exit status is saved to
  be accessed by other modules.</p>

<ul>
<li><code>timeout</code> (duration string)</li>
</ul>

<p>the amount of time the command will wait before halting forcefully. The
format is Go&rsquo;s duraction string. A duration string is a possibly signed
sequence of decimal numbers, each with optional fraction and a unit
suffix, such as &ldquo;300ms&rdquo;, &ldquo;-1.5h&rdquo; or &ldquo;2h45m&rdquo;. Valid time units are &ldquo;ns&rdquo;,
&ldquo;us&rdquo; (or &ldquo;Âµs&rdquo;), &ldquo;ms&rdquo;, &ldquo;s&rdquo;, &ldquo;m&rdquo;, &ldquo;h&rdquo;.</p>

<ul>
<li><code>dir</code> (string)</li>
</ul>

<p>the working directory this command should be run in</p>

<ul>
<li><code>env</code> (map of string to string)</li>
</ul>

<p>any environment variables that should be passed to the command</p>

<h2 id="exported-fields">Exported Fields</h2>

<p>The following fields are available from other modules via <code>lookup</code></p>

<ul>
<li><code>CheckStmt</code> (string)</li>
</ul>

<p>the script that will be executed during planning.  It is the script provided
  to <code>check</code> with any template references resolved.</p>

<ul>
<li><code>ApplyStmt</code> (string)</li>
</ul>

<p>the script that will be executed during application.  It is the script
  provided to <code>apply</code> with any template references resolved.</p>

<ul>
<li><code>Dir</code> (string)</li>
</ul>

<p>the working directory of the script.  It will be an empty string if unset.</p>

<ul>
<li><code>Env</code> (list of strings)</li>
</ul>

<p>a list of environment variables passed into the script with <code>env</code> in the form
  of <code>key=value</code>. If no environment variables were set then it returns an empty
  list.</p>

<ul>
<li><code>Status</code> (command results)</li>
</ul>

<p>the execution status of the last task that was run.  During planning this will
  be the result of <code>check</code>, and during application it will be the result of
  <code>apply</code>.</p>

<ul>
<li><code>CheckStatus</code> (command results)</li>
</ul>

<p>the status of the initial <code>check</code> run.  During planning this is equivivlent to
  <code>Status</code>, during application this will provide access to the results of the
  initial call to <code>check</code>.</p>

<h3 id="command-results">Command Results</h3>

<p>The command results structure provides fields related to the execution status of
a task.  <code>Status</code> and <code>CheckStatus</code> both return command results type fields that
allow you to access any of these defined fields.</p>

<ul>
<li><code>ExitStatus</code> (unsigned integer)</li>
</ul>

<p>the exit code of the process. The meaning of the fields is system dependent.</p>

<ul>
<li><code>Stdout</code> (string)</li>
</ul>

<p>contains all data written to stdout by the process.</p>

<ul>
<li><code>Stderr</code> (string)</li>
</ul>

<p>contains all data written to stderr by the process.</p>


			<aside class="copyright" role="note">
				
				&copy; 2016 Released under the Apache 2.0 license &ndash;
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="http://converge.aster.is/resources/task/" title="task">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              task
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="http://converge.aster.is/resources/file-content/" title="file.content">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              file.content
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = 'http:\/\/converge.aster.is\/';
      var repo_id  = 'asteris-llc\/converge';
    
    </script>

    <script src="http://converge.aster.is/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;
            
            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }
        

        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }
    </script>

    

    <script src="//gohugo.io/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>
