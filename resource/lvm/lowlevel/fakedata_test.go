package lowlevel_test

import (
	"github.com/asteris-llc/converge/resource/lvm/lowlevel"
	"github.com/stretchr/testify/assert"
	"github.com/stretchr/testify/mock"
	"github.com/stretchr/testify/require"
	"testing"
)

type FakeDataExecutor struct {
	mock.Mock
	Pvs     string
	Vgs     string
	Lvs     map[string]string
	Blkid   map[string]string
	Dmsetup map[string]string
}

func (e *FakeDataExecutor) Run(prog string, args []string) error {
	c := e.Called(prog, args)
	return c.Error(0)
}

func (e *FakeDataExecutor) RunExitCode(prog string, args []string) (int, error) {
	c := e.Called(prog, args)
	return c.Int(0), c.Error(1)
}

// real data from avn@bulldozer (uuids mangled for secutiry consideration)
const TESTDATA_PVS = "LVM2_PV_FMT=lvm2;LVM2_PV_UUID=5uADPK-2pG5-ryrX-tn87-BgtO-ZvV4-rm7J7t;LVM2_DEV_SIZE=999941799936;LVM2_PV_NAME=/dev/md127;LVM2_PV_MDA_FREE=516608;LVM2_PV_MDA_SIZE=1044480;LVM2_PE_START=1048576;LVM2_PV_SIZE=999938850816;LVM2_PV_FREE=149795373056;LVM2_PV_USED=850143477760;LVM2_PV_ATTR=a--;LVM2_PV_ALLOCATABLE=allocatable;LVM2_PV_EXPORTED=;LVM2_PV_MISSING=;LVM2_PV_PE_COUNT=238404;LVM2_PV_PE_ALLOC_COUNT=202690;LVM2_PV_TAGS=;LVM2_PV_MDA_COUNT=1;LVM2_PV_MDA_USED_COUNT=1;LVM2_PV_BA_START=0;LVM2_PV_BA_SIZE=0;LVM2_VG_NAME=vg0"

const TESTDATA_VGS = "LVM2_VG_FMT=lvm2;LVM2_VG_UUID=3UVZM0-42jt-qlbl-FGUH-XhD0-n2IL-D5b19F;LVM2_VG_NAME=vg0;LVM2_VG_ATTR=wz--n-;LVM2_VG_PERMISSIONS=writeable;LVM2_VG_EXTENDABLE=extendable;LVM2_VG_EXPORTED=;LVM2_VG_PARTIAL=;LVM2_VG_ALLOCATION_POLICY=normal;LVM2_VG_CLUSTERED=;LVM2_VG_SIZE=999938850816;LVM2_VG_FREE=149795373056;LVM2_VG_SYSID=;LVM2_VG_SYSTEMID=;LVM2_VG_LOCKTYPE=;LVM2_VG_LOCKARGS=;LVM2_VG_EXTENT_SIZE=4194304;LVM2_VG_EXTENT_COUNT=238404;LVM2_VG_FREE_COUNT=35714;LVM2_MAX_LV=0;LVM2_MAX_PV=0;LVM2_PV_COUNT=1;LVM2_VG_MISSING_PV_COUNT=0;LVM2_LV_COUNT=11;LVM2_SNAP_COUNT=0;LVM2_VG_SEQNO=20;LVM2_VG_TAGS=;LVM2_VG_PROFILE=;LVM2_VG_MDA_COUNT=1;LVM2_VG_MDA_USED_COUNT=1;LVM2_VG_MDA_FREE=516608;LVM2_VG_MDA_SIZE=1044480;LVM2_VG_MDA_COPIES=unmanaged"

const TESTDATA_LVS = `LVM2_LV_UUID=1v0Eub-b6s9-HL2F-KUfm-EHZt-D3uE-jmKid3;LVM2_LV_NAME=data;LVM2_LV_FULL_NAME=vg0/data;LVM2_LV_PATH=/dev/vg0/data;LVM2_LV_DM_PATH=/dev/mapper/vg0-data;LVM2_LV_PARENT=;LVM2_LV_ATTR=-wi-ao----;LVM2_LV_LAYOUT=linear;LVM2_LV_ROLE=public;LVM2_LV_INITIAL_IMAGE_SYNC=;LVM2_LV_IMAGE_SYNCED=;LVM2_LV_MERGING=;LVM2_LV_CONVERTING=;LVM2_LV_ALLOCATION_POLICY=inherit;LVM2_LV_ALLOCATION_LOCKED=;LVM2_LV_FIXED_MINOR=;LVM2_LV_MERGE_FAILED=unknown;LVM2_LV_SNAPSHOT_INVALID=unknown;LVM2_LV_SKIP_ACTIVATION=;LVM2_LV_WHEN_FULL=;LVM2_LV_ACTIVE=active;LVM2_LV_ACTIVE_LOCALLY=active locally;LVM2_LV_ACTIVE_REMOTELY=;LVM2_LV_ACTIVE_EXCLUSIVELY=active exclusively;LVM2_LV_MAJOR=-1;LVM2_LV_MINOR=-1;LVM2_LV_READ_AHEAD=auto;LVM2_LV_SIZE=107374182400;LVM2_LV_METADATA_SIZE=;LVM2_SEG_COUNT=1;LVM2_ORIGIN=;LVM2_ORIGIN_UUID=;LVM2_ORIGIN_SIZE=;LVM2_LV_ANCESTORS=;LVM2_LV_DESCENDANTS=;LVM2_DATA_PERCENT=;LVM2_SNAP_PERCENT=;LVM2_METADATA_PERCENT=;LVM2_COPY_PERCENT=;LVM2_SYNC_PERCENT=;LVM2_RAID_MISMATCH_COUNT=;LVM2_RAID_SYNC_ACTION=;LVM2_RAID_WRITE_BEHIND=;LVM2_RAID_MIN_RECOVERY_RATE=;LVM2_RAID_MAX_RECOVERY_RATE=;LVM2_MOVE_PV=;LVM2_MOVE_PV_UUID=;LVM2_CONVERT_LV=;LVM2_CONVERT_LV_UUID=;LVM2_MIRROR_LOG=;LVM2_MIRROR_LOG_UUID=;LVM2_DATA_LV=;LVM2_DATA_LV_UUID=;LVM2_METADATA_LV=;LVM2_METADATA_LV_UUID=;LVM2_POOL_LV=;LVM2_POOL_LV_UUID=;LVM2_LV_TAGS=;LVM2_LV_PROFILE=;LVM2_LV_LOCKARGS=;LVM2_LV_TIME=2013-11-06 15:55:02 +0200;LVM2_LV_HOST=bulldozer;LVM2_LV_MODULES=;LVM2_LV_KERNEL_MAJOR=254;LVM2_LV_KERNEL_MINOR=7;LVM2_LV_KERNEL_READ_AHEAD=131072;LVM2_LV_PERMISSIONS=writeable;LVM2_LV_SUSPENDED=;LVM2_LV_LIVE_TABLE=live table present;LVM2_LV_INACTIVE_TABLE=;LVM2_LV_DEVICE_OPEN=open;LVM2_CACHE_TOTAL_BLOCKS=;LVM2_CACHE_USED_BLOCKS=;LVM2_CACHE_DIRTY_BLOCKS=;LVM2_CACHE_READ_HITS=;LVM2_CACHE_READ_MISSES=;LVM2_CACHE_WRITE_HITS=;LVM2_CACHE_WRITE_MISSES=;LVM2_LV_HEALTH_STATUS=;LVM2_KERNEL_DISCARDS=;LVM2_VG_FMT=lvm2;LVM2_VG_UUID=3UVZM0-42jt-qlbl-FGUH-XhD0-n2IL-D5b19F;LVM2_VG_NAME=vg0;LVM2_VG_ATTR=wz--n-;LVM2_VG_PERMISSIONS=writeable;LVM2_VG_EXTENDABLE=extendable;LVM2_VG_EXPORTED=;LVM2_VG_PARTIAL=;LVM2_VG_ALLOCATION_POLICY=normal;LVM2_VG_CLUSTERED=;LVM2_VG_SIZE=999938850816;LVM2_VG_FREE=149795373056;LVM2_VG_SYSID=;LVM2_VG_SYSTEMID=;LVM2_VG_LOCKTYPE=;LVM2_VG_LOCKARGS=;LVM2_VG_EXTENT_SIZE=4194304;LVM2_VG_EXTENT_COUNT=238404;LVM2_VG_FREE_COUNT=35714;LVM2_MAX_LV=0;LVM2_MAX_PV=0;LVM2_PV_COUNT=1;LVM2_VG_MISSING_PV_COUNT=0;LVM2_LV_COUNT=11;LVM2_SNAP_COUNT=0;LVM2_VG_SEQNO=20;LVM2_VG_TAGS=;LVM2_VG_PROFILE=;LVM2_VG_MDA_COUNT=1;LVM2_VG_MDA_USED_COUNT=1;LVM2_VG_MDA_FREE=516608;LVM2_VG_MDA_SIZE=1044480;LVM2_VG_MDA_COPIES=unmanaged
  LVM2_LV_UUID=LDIJR6-W0Zm-FO7Z-0Lkw-fDec-mO6q-0OYkns;LVM2_LV_NAME=games;LVM2_LV_FULL_NAME=vg0/games;LVM2_LV_PATH=/dev/vg0/games;LVM2_LV_DM_PATH=/dev/mapper/vg0-games;LVM2_LV_PARENT=;LVM2_LV_ATTR=-wi-ao----;LVM2_LV_LAYOUT=linear;LVM2_LV_ROLE=public;LVM2_LV_INITIAL_IMAGE_SYNC=;LVM2_LV_IMAGE_SYNCED=;LVM2_LV_MERGING=;LVM2_LV_CONVERTING=;LVM2_LV_ALLOCATION_POLICY=inherit;LVM2_LV_ALLOCATION_LOCKED=;LVM2_LV_FIXED_MINOR=;LVM2_LV_MERGE_FAILED=unknown;LVM2_LV_SNAPSHOT_INVALID=unknown;LVM2_LV_SKIP_ACTIVATION=;LVM2_LV_WHEN_FULL=;LVM2_LV_ACTIVE=active;LVM2_LV_ACTIVE_LOCALLY=active locally;LVM2_LV_ACTIVE_REMOTELY=;LVM2_LV_ACTIVE_EXCLUSIVELY=active exclusively;LVM2_LV_MAJOR=-1;LVM2_LV_MINOR=-1;LVM2_LV_READ_AHEAD=auto;LVM2_LV_SIZE=51539607552;LVM2_LV_METADATA_SIZE=;LVM2_SEG_COUNT=2;LVM2_ORIGIN=;LVM2_ORIGIN_UUID=;LVM2_ORIGIN_SIZE=;LVM2_LV_ANCESTORS=;LVM2_LV_DESCENDANTS=;LVM2_DATA_PERCENT=;LVM2_SNAP_PERCENT=;LVM2_METADATA_PERCENT=;LVM2_COPY_PERCENT=;LVM2_SYNC_PERCENT=;LVM2_RAID_MISMATCH_COUNT=;LVM2_RAID_SYNC_ACTION=;LVM2_RAID_WRITE_BEHIND=;LVM2_RAID_MIN_RECOVERY_RATE=;LVM2_RAID_MAX_RECOVERY_RATE=;LVM2_MOVE_PV=;LVM2_MOVE_PV_UUID=;LVM2_CONVERT_LV=;LVM2_CONVERT_LV_UUID=;LVM2_MIRROR_LOG=;LVM2_MIRROR_LOG_UUID=;LVM2_DATA_LV=;LVM2_DATA_LV_UUID=;LVM2_METADATA_LV=;LVM2_METADATA_LV_UUID=;LVM2_POOL_LV=;LVM2_POOL_LV_UUID=;LVM2_LV_TAGS=;LVM2_LV_PROFILE=;LVM2_LV_LOCKARGS=;LVM2_LV_TIME=2013-11-06 00:54:11 +0200;LVM2_LV_HOST=bulldozer;LVM2_LV_MODULES=;LVM2_LV_KERNEL_MAJOR=254;LVM2_LV_KERNEL_MINOR=4;LVM2_LV_KERNEL_READ_AHEAD=131072;LVM2_LV_PERMISSIONS=writeable;LVM2_LV_SUSPENDED=;LVM2_LV_LIVE_TABLE=live table present;LVM2_LV_INACTIVE_TABLE=;LVM2_LV_DEVICE_OPEN=open;LVM2_CACHE_TOTAL_BLOCKS=;LVM2_CACHE_USED_BLOCKS=;LVM2_CACHE_DIRTY_BLOCKS=;LVM2_CACHE_READ_HITS=;LVM2_CACHE_READ_MISSES=;LVM2_CACHE_WRITE_HITS=;LVM2_CACHE_WRITE_MISSES=;LVM2_LV_HEALTH_STATUS=;LVM2_KERNEL_DISCARDS=;LVM2_VG_FMT=lvm2;LVM2_VG_UUID=3UVZM0-42jt-qlbl-FGUH-XhD0-n2IL-D5b19F;LVM2_VG_NAME=vg0;LVM2_VG_ATTR=wz--n-;LVM2_VG_PERMISSIONS=writeable;LVM2_VG_EXTENDABLE=extendable;LVM2_VG_EXPORTED=;LVM2_VG_PARTIAL=;LVM2_VG_ALLOCATION_POLICY=normal;LVM2_VG_CLUSTERED=;LVM2_VG_SIZE=999938850816;LVM2_VG_FREE=149795373056;LVM2_VG_SYSID=;LVM2_VG_SYSTEMID=;LVM2_VG_LOCKTYPE=;LVM2_VG_LOCKARGS=;LVM2_VG_EXTENT_SIZE=4194304;LVM2_VG_EXTENT_COUNT=238404;LVM2_VG_FREE_COUNT=35714;LVM2_MAX_LV=0;LVM2_MAX_PV=0;LVM2_PV_COUNT=1;LVM2_VG_MISSING_PV_COUNT=0;LVM2_LV_COUNT=11;LVM2_SNAP_COUNT=0;LVM2_VG_SEQNO=20;LVM2_VG_TAGS=;LVM2_VG_PROFILE=;LVM2_VG_MDA_COUNT=1;LVM2_VG_MDA_USED_COUNT=1;LVM2_VG_MDA_FREE=516608;LVM2_VG_MDA_SIZE=1044480;LVM2_VG_MDA_COPIES=unmanaged
  LVM2_LV_UUID=EdYwBs-QPj5-hnZ3-grvR-6upx-uAOK-IdZkZl;LVM2_LV_NAME=home;LVM2_LV_FULL_NAME=vg0/home;LVM2_LV_PATH=/dev/vg0/home;LVM2_LV_DM_PATH=/dev/mapper/vg0-home;LVM2_LV_PARENT=;LVM2_LV_ATTR=-wi-ao----;LVM2_LV_LAYOUT=linear;LVM2_LV_ROLE=public;LVM2_LV_INITIAL_IMAGE_SYNC=;LVM2_LV_IMAGE_SYNCED=;LVM2_LV_MERGING=;LVM2_LV_CONVERTING=;LVM2_LV_ALLOCATION_POLICY=inherit;LVM2_LV_ALLOCATION_LOCKED=;LVM2_LV_FIXED_MINOR=;LVM2_LV_MERGE_FAILED=unknown;LVM2_LV_SNAPSHOT_INVALID=unknown;LVM2_LV_SKIP_ACTIVATION=;LVM2_LV_WHEN_FULL=;LVM2_LV_ACTIVE=active;LVM2_LV_ACTIVE_LOCALLY=active locally;LVM2_LV_ACTIVE_REMOTELY=;LVM2_LV_ACTIVE_EXCLUSIVELY=active exclusively;LVM2_LV_MAJOR=-1;LVM2_LV_MINOR=-1;LVM2_LV_READ_AHEAD=auto;LVM2_LV_SIZE=40802189312;LVM2_LV_METADATA_SIZE=;LVM2_SEG_COUNT=3;LVM2_ORIGIN=;LVM2_ORIGIN_UUID=;LVM2_ORIGIN_SIZE=;LVM2_LV_ANCESTORS=;LVM2_LV_DESCENDANTS=;LVM2_DATA_PERCENT=;LVM2_SNAP_PERCENT=;LVM2_METADATA_PERCENT=;LVM2_COPY_PERCENT=;LVM2_SYNC_PERCENT=;LVM2_RAID_MISMATCH_COUNT=;LVM2_RAID_SYNC_ACTION=;LVM2_RAID_WRITE_BEHIND=;LVM2_RAID_MIN_RECOVERY_RATE=;LVM2_RAID_MAX_RECOVERY_RATE=;LVM2_MOVE_PV=;LVM2_MOVE_PV_UUID=;LVM2_CONVERT_LV=;LVM2_CONVERT_LV_UUID=;LVM2_MIRROR_LOG=;LVM2_MIRROR_LOG_UUID=;LVM2_DATA_LV=;LVM2_DATA_LV_UUID=;LVM2_METADATA_LV=;LVM2_METADATA_LV_UUID=;LVM2_POOL_LV=;LVM2_POOL_LV_UUID=;LVM2_LV_TAGS=;LVM2_LV_PROFILE=;LVM2_LV_LOCKARGS=;LVM2_LV_TIME=2013-11-05 16:55:24 +0200;LVM2_LV_HOST=bulldozer;LVM2_LV_MODULES=;LVM2_LV_KERNEL_MAJOR=254;LVM2_LV_KERNEL_MINOR=2;LVM2_LV_KERNEL_READ_AHEAD=131072;LVM2_LV_PERMISSIONS=writeable;LVM2_LV_SUSPENDED=;LVM2_LV_LIVE_TABLE=live table present;LVM2_LV_INACTIVE_TABLE=;LVM2_LV_DEVICE_OPEN=open;LVM2_CACHE_TOTAL_BLOCKS=;LVM2_CACHE_USED_BLOCKS=;LVM2_CACHE_DIRTY_BLOCKS=;LVM2_CACHE_READ_HITS=;LVM2_CACHE_READ_MISSES=;LVM2_CACHE_WRITE_HITS=;LVM2_CACHE_WRITE_MISSES=;LVM2_LV_HEALTH_STATUS=;LVM2_KERNEL_DISCARDS=;LVM2_VG_FMT=lvm2;LVM2_VG_UUID=3UVZM0-42jt-qlbl-FGUH-XhD0-n2IL-D5b19F;LVM2_VG_NAME=vg0;LVM2_VG_ATTR=wz--n-;LVM2_VG_PERMISSIONS=writeable;LVM2_VG_EXTENDABLE=extendable;LVM2_VG_EXPORTED=;LVM2_VG_PARTIAL=;LVM2_VG_ALLOCATION_POLICY=normal;LVM2_VG_CLUSTERED=;LVM2_VG_SIZE=999938850816;LVM2_VG_FREE=149795373056;LVM2_VG_SYSID=;LVM2_VG_SYSTEMID=;LVM2_VG_LOCKTYPE=;LVM2_VG_LOCKARGS=;LVM2_VG_EXTENT_SIZE=4194304;LVM2_VG_EXTENT_COUNT=238404;LVM2_VG_FREE_COUNT=35714;LVM2_MAX_LV=0;LVM2_MAX_PV=0;LVM2_PV_COUNT=1;LVM2_VG_MISSING_PV_COUNT=0;LVM2_LV_COUNT=11;LVM2_SNAP_COUNT=0;LVM2_VG_SEQNO=20;LVM2_VG_TAGS=;LVM2_VG_PROFILE=;LVM2_VG_MDA_COUNT=1;LVM2_VG_MDA_USED_COUNT=1;LVM2_VG_MDA_FREE=516608;LVM2_VG_MDA_SIZE=1044480;LVM2_VG_MDA_COPIES=unmanaged
  LVM2_LV_UUID=Clpz7r-Tkwd-OAwZ-JHoc-ke05-oSSB-buJ9TX;LVM2_LV_NAME=nixos;LVM2_LV_FULL_NAME=vg0/nixos;LVM2_LV_PATH=/dev/vg0/nixos;LVM2_LV_DM_PATH=/dev/mapper/vg0-nixos;LVM2_LV_PARENT=;LVM2_LV_ATTR=-wi-ao----;LVM2_LV_LAYOUT=linear;LVM2_LV_ROLE=public;LVM2_LV_INITIAL_IMAGE_SYNC=;LVM2_LV_IMAGE_SYNCED=;LVM2_LV_MERGING=;LVM2_LV_CONVERTING=;LVM2_LV_ALLOCATION_POLICY=inherit;LVM2_LV_ALLOCATION_LOCKED=;LVM2_LV_FIXED_MINOR=;LVM2_LV_MERGE_FAILED=unknown;LVM2_LV_SNAPSHOT_INVALID=unknown;LVM2_LV_SKIP_ACTIVATION=;LVM2_LV_WHEN_FULL=;LVM2_LV_ACTIVE=active;LVM2_LV_ACTIVE_LOCALLY=active locally;LVM2_LV_ACTIVE_REMOTELY=;LVM2_LV_ACTIVE_EXCLUSIVELY=active exclusively;LVM2_LV_MAJOR=-1;LVM2_LV_MINOR=-1;LVM2_LV_READ_AHEAD=auto;LVM2_LV_SIZE=214748364800;LVM2_LV_METADATA_SIZE=;LVM2_SEG_COUNT=1;LVM2_ORIGIN=;LVM2_ORIGIN_UUID=;LVM2_ORIGIN_SIZE=;LVM2_LV_ANCESTORS=;LVM2_LV_DESCENDANTS=;LVM2_DATA_PERCENT=;LVM2_SNAP_PERCENT=;LVM2_METADATA_PERCENT=;LVM2_COPY_PERCENT=;LVM2_SYNC_PERCENT=;LVM2_RAID_MISMATCH_COUNT=;LVM2_RAID_SYNC_ACTION=;LVM2_RAID_WRITE_BEHIND=;LVM2_RAID_MIN_RECOVERY_RATE=;LVM2_RAID_MAX_RECOVERY_RATE=;LVM2_MOVE_PV=;LVM2_MOVE_PV_UUID=;LVM2_CONVERT_LV=;LVM2_CONVERT_LV_UUID=;LVM2_MIRROR_LOG=;LVM2_MIRROR_LOG_UUID=;LVM2_DATA_LV=;LVM2_DATA_LV_UUID=;LVM2_METADATA_LV=;LVM2_METADATA_LV_UUID=;LVM2_POOL_LV=;LVM2_POOL_LV_UUID=;LVM2_LV_TAGS=;LVM2_LV_PROFILE=;LVM2_LV_LOCKARGS=;LVM2_LV_TIME=2015-01-24 12:52:49 +0200;LVM2_LV_HOST=bulldozer;LVM2_LV_MODULES=;LVM2_LV_KERNEL_MAJOR=254;LVM2_LV_KERNEL_MINOR=9;LVM2_LV_KERNEL_READ_AHEAD=131072;LVM2_LV_PERMISSIONS=writeable;LVM2_LV_SUSPENDED=;LVM2_LV_LIVE_TABLE=live table present;LVM2_LV_INACTIVE_TABLE=;LVM2_LV_DEVICE_OPEN=open;LVM2_CACHE_TOTAL_BLOCKS=;LVM2_CACHE_USED_BLOCKS=;LVM2_CACHE_DIRTY_BLOCKS=;LVM2_CACHE_READ_HITS=;LVM2_CACHE_READ_MISSES=;LVM2_CACHE_WRITE_HITS=;LVM2_CACHE_WRITE_MISSES=;LVM2_LV_HEALTH_STATUS=;LVM2_KERNEL_DISCARDS=;LVM2_VG_FMT=lvm2;LVM2_VG_UUID=3UVZM0-42jt-qlbl-FGUH-XhD0-n2IL-D5b19F;LVM2_VG_NAME=vg0;LVM2_VG_ATTR=wz--n-;LVM2_VG_PERMISSIONS=writeable;LVM2_VG_EXTENDABLE=extendable;LVM2_VG_EXPORTED=;LVM2_VG_PARTIAL=;LVM2_VG_ALLOCATION_POLICY=normal;LVM2_VG_CLUSTERED=;LVM2_VG_SIZE=999938850816;LVM2_VG_FREE=149795373056;LVM2_VG_SYSID=;LVM2_VG_SYSTEMID=;LVM2_VG_LOCKTYPE=;LVM2_VG_LOCKARGS=;LVM2_VG_EXTENT_SIZE=4194304;LVM2_VG_EXTENT_COUNT=238404;LVM2_VG_FREE_COUNT=35714;LVM2_MAX_LV=0;LVM2_MAX_PV=0;LVM2_PV_COUNT=1;LVM2_VG_MISSING_PV_COUNT=0;LVM2_LV_COUNT=11;LVM2_SNAP_COUNT=0;LVM2_VG_SEQNO=20;LVM2_VG_TAGS=;LVM2_VG_PROFILE=;LVM2_VG_MDA_COUNT=1;LVM2_VG_MDA_USED_COUNT=1;LVM2_VG_MDA_FREE=516608;LVM2_VG_MDA_SIZE=1044480;LVM2_VG_MDA_COPIES=unmanaged
  LVM2_LV_UUID=XcompU-ZVd2-ppNE-0IJ6-ahT6-aeLf-zIjekV;LVM2_LV_NAME=raid;LVM2_LV_FULL_NAME=vg0/raid;LVM2_LV_PATH=/dev/vg0/raid;LVM2_LV_DM_PATH=/dev/mapper/vg0-raid;LVM2_LV_PARENT=;LVM2_LV_ATTR=-wi-ao----;LVM2_LV_LAYOUT=linear;LVM2_LV_ROLE=public;LVM2_LV_INITIAL_IMAGE_SYNC=;LVM2_LV_IMAGE_SYNCED=;LVM2_LV_MERGING=;LVM2_LV_CONVERTING=;LVM2_LV_ALLOCATION_POLICY=inherit;LVM2_LV_ALLOCATION_LOCKED=;LVM2_LV_FIXED_MINOR=;LVM2_LV_MERGE_FAILED=unknown;LVM2_LV_SNAPSHOT_INVALID=unknown;LVM2_LV_SKIP_ACTIVATION=;LVM2_LV_WHEN_FULL=;LVM2_LV_ACTIVE=active;LVM2_LV_ACTIVE_LOCALLY=active locally;LVM2_LV_ACTIVE_REMOTELY=;LVM2_LV_ACTIVE_EXCLUSIVELY=active exclusively;LVM2_LV_MAJOR=-1;LVM2_LV_MINOR=-1;LVM2_LV_READ_AHEAD=auto;LVM2_LV_SIZE=32212254720;LVM2_LV_METADATA_SIZE=;LVM2_SEG_COUNT=1;LVM2_ORIGIN=;LVM2_ORIGIN_UUID=;LVM2_ORIGIN_SIZE=;LVM2_LV_ANCESTORS=;LVM2_LV_DESCENDANTS=;LVM2_DATA_PERCENT=;LVM2_SNAP_PERCENT=;LVM2_METADATA_PERCENT=;LVM2_COPY_PERCENT=;LVM2_SYNC_PERCENT=;LVM2_RAID_MISMATCH_COUNT=;LVM2_RAID_SYNC_ACTION=;LVM2_RAID_WRITE_BEHIND=;LVM2_RAID_MIN_RECOVERY_RATE=;LVM2_RAID_MAX_RECOVERY_RATE=;LVM2_MOVE_PV=;LVM2_MOVE_PV_UUID=;LVM2_CONVERT_LV=;LVM2_CONVERT_LV_UUID=;LVM2_MIRROR_LOG=;LVM2_MIRROR_LOG_UUID=;LVM2_DATA_LV=;LVM2_DATA_LV_UUID=;LVM2_METADATA_LV=;LVM2_METADATA_LV_UUID=;LVM2_POOL_LV=;LVM2_POOL_LV_UUID=;LVM2_LV_TAGS=;LVM2_LV_PROFILE=;LVM2_LV_LOCKARGS=;LVM2_LV_TIME=2013-11-06 15:54:03 +0200;LVM2_LV_HOST=bulldozer;LVM2_LV_MODULES=;LVM2_LV_KERNEL_MAJOR=254;LVM2_LV_KERNEL_MINOR=6;LVM2_LV_KERNEL_READ_AHEAD=131072;LVM2_LV_PERMISSIONS=writeable;LVM2_LV_SUSPENDED=;LVM2_LV_LIVE_TABLE=live table present;LVM2_LV_INACTIVE_TABLE=;LVM2_LV_DEVICE_OPEN=open;LVM2_CACHE_TOTAL_BLOCKS=;LVM2_CACHE_USED_BLOCKS=;LVM2_CACHE_DIRTY_BLOCKS=;LVM2_CACHE_READ_HITS=;LVM2_CACHE_READ_MISSES=;LVM2_CACHE_WRITE_HITS=;LVM2_CACHE_WRITE_MISSES=;LVM2_LV_HEALTH_STATUS=;LVM2_KERNEL_DISCARDS=;LVM2_VG_FMT=lvm2;LVM2_VG_UUID=3UVZM0-42jt-qlbl-FGUH-XhD0-n2IL-D5b19F;LVM2_VG_NAME=vg0;LVM2_VG_ATTR=wz--n-;LVM2_VG_PERMISSIONS=writeable;LVM2_VG_EXTENDABLE=extendable;LVM2_VG_EXPORTED=;LVM2_VG_PARTIAL=;LVM2_VG_ALLOCATION_POLICY=normal;LVM2_VG_CLUSTERED=;LVM2_VG_SIZE=999938850816;LVM2_VG_FREE=149795373056;LVM2_VG_SYSID=;LVM2_VG_SYSTEMID=;LVM2_VG_LOCKTYPE=;LVM2_VG_LOCKARGS=;LVM2_VG_EXTENT_SIZE=4194304;LVM2_VG_EXTENT_COUNT=238404;LVM2_VG_FREE_COUNT=35714;LVM2_MAX_LV=0;LVM2_MAX_PV=0;LVM2_PV_COUNT=1;LVM2_VG_MISSING_PV_COUNT=0;LVM2_LV_COUNT=11;LVM2_SNAP_COUNT=0;LVM2_VG_SEQNO=20;LVM2_VG_TAGS=;LVM2_VG_PROFILE=;LVM2_VG_MDA_COUNT=1;LVM2_VG_MDA_USED_COUNT=1;LVM2_VG_MDA_FREE=516608;LVM2_VG_MDA_SIZE=1044480;LVM2_VG_MDA_COPIES=unmanaged
  LVM2_LV_UUID=jkuyQV-3Z20-UlHv-S8T7-9tF8-gBK0-dnebaJ;LVM2_LV_NAME=rkt;LVM2_LV_FULL_NAME=vg0/rkt;LVM2_LV_PATH=/dev/vg0/rkt;LVM2_LV_DM_PATH=/dev/mapper/vg0-rkt;LVM2_LV_PARENT=;LVM2_LV_ATTR=-wi-ao----;LVM2_LV_LAYOUT=linear;LVM2_LV_ROLE=public;LVM2_LV_INITIAL_IMAGE_SYNC=;LVM2_LV_IMAGE_SYNCED=;LVM2_LV_MERGING=;LVM2_LV_CONVERTING=;LVM2_LV_ALLOCATION_POLICY=inherit;LVM2_LV_ALLOCATION_LOCKED=;LVM2_LV_FIXED_MINOR=;LVM2_LV_MERGE_FAILED=unknown;LVM2_LV_SNAPSHOT_INVALID=unknown;LVM2_LV_SKIP_ACTIVATION=;LVM2_LV_WHEN_FULL=;LVM2_LV_ACTIVE=active;LVM2_LV_ACTIVE_LOCALLY=active locally;LVM2_LV_ACTIVE_REMOTELY=;LVM2_LV_ACTIVE_EXCLUSIVELY=active exclusively;LVM2_LV_MAJOR=-1;LVM2_LV_MINOR=-1;LVM2_LV_READ_AHEAD=auto;LVM2_LV_SIZE=25769803776;LVM2_LV_METADATA_SIZE=;LVM2_SEG_COUNT=1;LVM2_ORIGIN=;LVM2_ORIGIN_UUID=;LVM2_ORIGIN_SIZE=;LVM2_LV_ANCESTORS=;LVM2_LV_DESCENDANTS=;LVM2_DATA_PERCENT=;LVM2_SNAP_PERCENT=;LVM2_METADATA_PERCENT=;LVM2_COPY_PERCENT=;LVM2_SYNC_PERCENT=;LVM2_RAID_MISMATCH_COUNT=;LVM2_RAID_SYNC_ACTION=;LVM2_RAID_WRITE_BEHIND=;LVM2_RAID_MIN_RECOVERY_RATE=;LVM2_RAID_MAX_RECOVERY_RATE=;LVM2_MOVE_PV=;LVM2_MOVE_PV_UUID=;LVM2_CONVERT_LV=;LVM2_CONVERT_LV_UUID=;LVM2_MIRROR_LOG=;LVM2_MIRROR_LOG_UUID=;LVM2_DATA_LV=;LVM2_DATA_LV_UUID=;LVM2_METADATA_LV=;LVM2_METADATA_LV_UUID=;LVM2_POOL_LV=;LVM2_POOL_LV_UUID=;LVM2_LV_TAGS=;LVM2_LV_PROFILE=;LVM2_LV_LOCKARGS=;LVM2_LV_TIME=2016-03-01 18:13:16 +0200;LVM2_LV_HOST=bulldozer;LVM2_LV_MODULES=;LVM2_LV_KERNEL_MAJOR=254;LVM2_LV_KERNEL_MINOR=10;LVM2_LV_KERNEL_READ_AHEAD=131072;LVM2_LV_PERMISSIONS=writeable;LVM2_LV_SUSPENDED=;LVM2_LV_LIVE_TABLE=live table present;LVM2_LV_INACTIVE_TABLE=;LVM2_LV_DEVICE_OPEN=open;LVM2_CACHE_TOTAL_BLOCKS=;LVM2_CACHE_USED_BLOCKS=;LVM2_CACHE_DIRTY_BLOCKS=;LVM2_CACHE_READ_HITS=;LVM2_CACHE_READ_MISSES=;LVM2_CACHE_WRITE_HITS=;LVM2_CACHE_WRITE_MISSES=;LVM2_LV_HEALTH_STATUS=;LVM2_KERNEL_DISCARDS=;LVM2_VG_FMT=lvm2;LVM2_VG_UUID=3UVZM0-42jt-qlbl-FGUH-XhD0-n2IL-D5b19F;LVM2_VG_NAME=vg0;LVM2_VG_ATTR=wz--n-;LVM2_VG_PERMISSIONS=writeable;LVM2_VG_EXTENDABLE=extendable;LVM2_VG_EXPORTED=;LVM2_VG_PARTIAL=;LVM2_VG_ALLOCATION_POLICY=normal;LVM2_VG_CLUSTERED=;LVM2_VG_SIZE=999938850816;LVM2_VG_FREE=149795373056;LVM2_VG_SYSID=;LVM2_VG_SYSTEMID=;LVM2_VG_LOCKTYPE=;LVM2_VG_LOCKARGS=;LVM2_VG_EXTENT_SIZE=4194304;LVM2_VG_EXTENT_COUNT=238404;LVM2_VG_FREE_COUNT=35714;LVM2_MAX_LV=0;LVM2_MAX_PV=0;LVM2_PV_COUNT=1;LVM2_VG_MISSING_PV_COUNT=0;LVM2_LV_COUNT=11;LVM2_SNAP_COUNT=0;LVM2_VG_SEQNO=20;LVM2_VG_TAGS=;LVM2_VG_PROFILE=;LVM2_VG_MDA_COUNT=1;LVM2_VG_MDA_USED_COUNT=1;LVM2_VG_MDA_FREE=516608;LVM2_VG_MDA_SIZE=1044480;LVM2_VG_MDA_COPIES=unmanaged
  LVM2_LV_UUID=gfWNV2-SoGn-DkFp-DeRW-viwd-ir8m-fq8dJY;LVM2_LV_NAME=root;LVM2_LV_FULL_NAME=vg0/root;LVM2_LV_PATH=/dev/vg0/root;LVM2_LV_DM_PATH=/dev/mapper/vg0-root;LVM2_LV_PARENT=;LVM2_LV_ATTR=-wi-ao----;LVM2_LV_LAYOUT=linear;LVM2_LV_ROLE=public;LVM2_LV_INITIAL_IMAGE_SYNC=;LVM2_LV_IMAGE_SYNCED=;LVM2_LV_MERGING=;LVM2_LV_CONVERTING=;LVM2_LV_ALLOCATION_POLICY=inherit;LVM2_LV_ALLOCATION_LOCKED=;LVM2_LV_FIXED_MINOR=;LVM2_LV_MERGE_FAILED=unknown;LVM2_LV_SNAPSHOT_INVALID=unknown;LVM2_LV_SKIP_ACTIVATION=;LVM2_LV_WHEN_FULL=;LVM2_LV_ACTIVE=active;LVM2_LV_ACTIVE_LOCALLY=active locally;LVM2_LV_ACTIVE_REMOTELY=;LVM2_LV_ACTIVE_EXCLUSIVELY=active exclusively;LVM2_LV_MAJOR=-1;LVM2_LV_MINOR=-1;LVM2_LV_READ_AHEAD=auto;LVM2_LV_SIZE=15997075456;LVM2_LV_METADATA_SIZE=;LVM2_SEG_COUNT=1;LVM2_ORIGIN=;LVM2_ORIGIN_UUID=;LVM2_ORIGIN_SIZE=;LVM2_LV_ANCESTORS=;LVM2_LV_DESCENDANTS=;LVM2_DATA_PERCENT=;LVM2_SNAP_PERCENT=;LVM2_METADATA_PERCENT=;LVM2_COPY_PERCENT=;LVM2_SYNC_PERCENT=;LVM2_RAID_MISMATCH_COUNT=;LVM2_RAID_SYNC_ACTION=;LVM2_RAID_WRITE_BEHIND=;LVM2_RAID_MIN_RECOVERY_RATE=;LVM2_RAID_MAX_RECOVERY_RATE=;LVM2_MOVE_PV=;LVM2_MOVE_PV_UUID=;LVM2_CONVERT_LV=;LVM2_CONVERT_LV_UUID=;LVM2_MIRROR_LOG=;LVM2_MIRROR_LOG_UUID=;LVM2_DATA_LV=;LVM2_DATA_LV_UUID=;LVM2_METADATA_LV=;LVM2_METADATA_LV_UUID=;LVM2_POOL_LV=;LVM2_POOL_LV_UUID=;LVM2_LV_TAGS=;LVM2_LV_PROFILE=;LVM2_LV_LOCKARGS=;LVM2_LV_TIME=2013-11-05 16:52:19 +0200;LVM2_LV_HOST=bulldozer;LVM2_LV_MODULES=;LVM2_LV_KERNEL_MAJOR=254;LVM2_LV_KERNEL_MINOR=0;LVM2_LV_KERNEL_READ_AHEAD=131072;LVM2_LV_PERMISSIONS=writeable;LVM2_LV_SUSPENDED=;LVM2_LV_LIVE_TABLE=live table present;LVM2_LV_INACTIVE_TABLE=;LVM2_LV_DEVICE_OPEN=open;LVM2_CACHE_TOTAL_BLOCKS=;LVM2_CACHE_USED_BLOCKS=;LVM2_CACHE_DIRTY_BLOCKS=;LVM2_CACHE_READ_HITS=;LVM2_CACHE_READ_MISSES=;LVM2_CACHE_WRITE_HITS=;LVM2_CACHE_WRITE_MISSES=;LVM2_LV_HEALTH_STATUS=;LVM2_KERNEL_DISCARDS=;LVM2_VG_FMT=lvm2;LVM2_VG_UUID=3UVZM0-42jt-qlbl-FGUH-XhD0-n2IL-D5b19F;LVM2_VG_NAME=vg0;LVM2_VG_ATTR=wz--n-;LVM2_VG_PERMISSIONS=writeable;LVM2_VG_EXTENDABLE=extendable;LVM2_VG_EXPORTED=;LVM2_VG_PARTIAL=;LVM2_VG_ALLOCATION_POLICY=normal;LVM2_VG_CLUSTERED=;LVM2_VG_SIZE=999938850816;LVM2_VG_FREE=149795373056;LVM2_VG_SYSID=;LVM2_VG_SYSTEMID=;LVM2_VG_LOCKTYPE=;LVM2_VG_LOCKARGS=;LVM2_VG_EXTENT_SIZE=4194304;LVM2_VG_EXTENT_COUNT=238404;LVM2_VG_FREE_COUNT=35714;LVM2_MAX_LV=0;LVM2_MAX_PV=0;LVM2_PV_COUNT=1;LVM2_VG_MISSING_PV_COUNT=0;LVM2_LV_COUNT=11;LVM2_SNAP_COUNT=0;LVM2_VG_SEQNO=20;LVM2_VG_TAGS=;LVM2_VG_PROFILE=;LVM2_VG_MDA_COUNT=1;LVM2_VG_MDA_USED_COUNT=1;LVM2_VG_MDA_FREE=516608;LVM2_VG_MDA_SIZE=1044480;LVM2_VG_MDA_COPIES=unmanaged
  LVM2_LV_UUID=MIziOx-KRos-T926-HKXS-6r0i-R1V4-ldfYw5;LVM2_LV_NAME=swap;LVM2_LV_FULL_NAME=vg0/swap;LVM2_LV_PATH=/dev/vg0/swap;LVM2_LV_DM_PATH=/dev/mapper/vg0-swap;LVM2_LV_PARENT=;LVM2_LV_ATTR=-wi-ao----;LVM2_LV_LAYOUT=linear;LVM2_LV_ROLE=public;LVM2_LV_INITIAL_IMAGE_SYNC=;LVM2_LV_IMAGE_SYNCED=;LVM2_LV_MERGING=;LVM2_LV_CONVERTING=;LVM2_LV_ALLOCATION_POLICY=inherit;LVM2_LV_ALLOCATION_LOCKED=;LVM2_LV_FIXED_MINOR=;LVM2_LV_MERGE_FAILED=unknown;LVM2_LV_SNAPSHOT_INVALID=unknown;LVM2_LV_SKIP_ACTIVATION=;LVM2_LV_WHEN_FULL=;LVM2_LV_ACTIVE=active;LVM2_LV_ACTIVE_LOCALLY=active locally;LVM2_LV_ACTIVE_REMOTELY=;LVM2_LV_ACTIVE_EXCLUSIVELY=active exclusively;LVM2_LV_MAJOR=-1;LVM2_LV_MINOR=-1;LVM2_LV_READ_AHEAD=auto;LVM2_LV_SIZE=34359738368;LVM2_LV_METADATA_SIZE=;LVM2_SEG_COUNT=1;LVM2_ORIGIN=;LVM2_ORIGIN_UUID=;LVM2_ORIGIN_SIZE=;LVM2_LV_ANCESTORS=;LVM2_LV_DESCENDANTS=;LVM2_DATA_PERCENT=;LVM2_SNAP_PERCENT=;LVM2_METADATA_PERCENT=;LVM2_COPY_PERCENT=;LVM2_SYNC_PERCENT=;LVM2_RAID_MISMATCH_COUNT=;LVM2_RAID_SYNC_ACTION=;LVM2_RAID_WRITE_BEHIND=;LVM2_RAID_MIN_RECOVERY_RATE=;LVM2_RAID_MAX_RECOVERY_RATE=;LVM2_MOVE_PV=;LVM2_MOVE_PV_UUID=;LVM2_CONVERT_LV=;LVM2_CONVERT_LV_UUID=;LVM2_MIRROR_LOG=;LVM2_MIRROR_LOG_UUID=;LVM2_DATA_LV=;LVM2_DATA_LV_UUID=;LVM2_METADATA_LV=;LVM2_METADATA_LV_UUID=;LVM2_POOL_LV=;LVM2_POOL_LV_UUID=;LVM2_LV_TAGS=;LVM2_LV_PROFILE=;LVM2_LV_LOCKARGS=;LVM2_LV_TIME=2013-11-06 15:55:08 +0200;LVM2_LV_HOST=bulldozer;LVM2_LV_MODULES=;LVM2_LV_KERNEL_MAJOR=254;LVM2_LV_KERNEL_MINOR=8;LVM2_LV_KERNEL_READ_AHEAD=131072;LVM2_LV_PERMISSIONS=writeable;LVM2_LV_SUSPENDED=;LVM2_LV_LIVE_TABLE=live table present;LVM2_LV_INACTIVE_TABLE=;LVM2_LV_DEVICE_OPEN=open;LVM2_CACHE_TOTAL_BLOCKS=;LVM2_CACHE_USED_BLOCKS=;LVM2_CACHE_DIRTY_BLOCKS=;LVM2_CACHE_READ_HITS=;LVM2_CACHE_READ_MISSES=;LVM2_CACHE_WRITE_HITS=;LVM2_CACHE_WRITE_MISSES=;LVM2_LV_HEALTH_STATUS=;LVM2_KERNEL_DISCARDS=;LVM2_VG_FMT=lvm2;LVM2_VG_UUID=3UVZM0-42jt-qlbl-FGUH-XhD0-n2IL-D5b19F;LVM2_VG_NAME=vg0;LVM2_VG_ATTR=wz--n-;LVM2_VG_PERMISSIONS=writeable;LVM2_VG_EXTENDABLE=extendable;LVM2_VG_EXPORTED=;LVM2_VG_PARTIAL=;LVM2_VG_ALLOCATION_POLICY=normal;LVM2_VG_CLUSTERED=;LVM2_VG_SIZE=999938850816;LVM2_VG_FREE=149795373056;LVM2_VG_SYSID=;LVM2_VG_SYSTEMID=;LVM2_VG_LOCKTYPE=;LVM2_VG_LOCKARGS=;LVM2_VG_EXTENT_SIZE=4194304;LVM2_VG_EXTENT_COUNT=238404;LVM2_VG_FREE_COUNT=35714;LVM2_MAX_LV=0;LVM2_MAX_PV=0;LVM2_PV_COUNT=1;LVM2_VG_MISSING_PV_COUNT=0;LVM2_LV_COUNT=11;LVM2_SNAP_COUNT=0;LVM2_VG_SEQNO=20;LVM2_VG_TAGS=;LVM2_VG_PROFILE=;LVM2_VG_MDA_COUNT=1;LVM2_VG_MDA_USED_COUNT=1;LVM2_VG_MDA_FREE=516608;LVM2_VG_MDA_SIZE=1044480;LVM2_VG_MDA_COPIES=unmanaged
  LVM2_LV_UUID=bBvzXq-vaGn-a2vm-2E6T-yJ0V-Wxhu-ufbBQj;LVM2_LV_NAME=systems;LVM2_LV_FULL_NAME=vg0/systems;LVM2_LV_PATH=/dev/vg0/systems;LVM2_LV_DM_PATH=/dev/mapper/vg0-systems;LVM2_LV_PARENT=;LVM2_LV_ATTR=-wi-ao----;LVM2_LV_LAYOUT=linear;LVM2_LV_ROLE=public;LVM2_LV_INITIAL_IMAGE_SYNC=;LVM2_LV_IMAGE_SYNCED=;LVM2_LV_MERGING=;LVM2_LV_CONVERTING=;LVM2_LV_ALLOCATION_POLICY=inherit;LVM2_LV_ALLOCATION_LOCKED=;LVM2_LV_FIXED_MINOR=;LVM2_LV_MERGE_FAILED=unknown;LVM2_LV_SNAPSHOT_INVALID=unknown;LVM2_LV_SKIP_ACTIVATION=;LVM2_LV_WHEN_FULL=;LVM2_LV_ACTIVE=active;LVM2_LV_ACTIVE_LOCALLY=active locally;LVM2_LV_ACTIVE_REMOTELY=;LVM2_LV_ACTIVE_EXCLUSIVELY=active exclusively;LVM2_LV_MAJOR=-1;LVM2_LV_MINOR=-1;LVM2_LV_READ_AHEAD=auto;LVM2_LV_SIZE=55834574848;LVM2_LV_METADATA_SIZE=;LVM2_SEG_COUNT=2;LVM2_ORIGIN=;LVM2_ORIGIN_UUID=;LVM2_ORIGIN_SIZE=;LVM2_LV_ANCESTORS=;LVM2_LV_DESCENDANTS=;LVM2_DATA_PERCENT=;LVM2_SNAP_PERCENT=;LVM2_METADATA_PERCENT=;LVM2_COPY_PERCENT=;LVM2_SYNC_PERCENT=;LVM2_RAID_MISMATCH_COUNT=;LVM2_RAID_SYNC_ACTION=;LVM2_RAID_WRITE_BEHIND=;LVM2_RAID_MIN_RECOVERY_RATE=;LVM2_RAID_MAX_RECOVERY_RATE=;LVM2_MOVE_PV=;LVM2_MOVE_PV_UUID=;LVM2_CONVERT_LV=;LVM2_CONVERT_LV_UUID=;LVM2_MIRROR_LOG=;LVM2_MIRROR_LOG_UUID=;LVM2_DATA_LV=;LVM2_DATA_LV_UUID=;LVM2_METADATA_LV=;LVM2_METADATA_LV_UUID=;LVM2_POOL_LV=;LVM2_POOL_LV_UUID=;LVM2_LV_TAGS=;LVM2_LV_PROFILE=;LVM2_LV_LOCKARGS=;LVM2_LV_TIME=2013-11-06 00:49:06 +0200;LVM2_LV_HOST=bulldozer;LVM2_LV_MODULES=;LVM2_LV_KERNEL_MAJOR=254;LVM2_LV_KERNEL_MINOR=3;LVM2_LV_KERNEL_READ_AHEAD=131072;LVM2_LV_PERMISSIONS=writeable;LVM2_LV_SUSPENDED=;LVM2_LV_LIVE_TABLE=live table present;LVM2_LV_INACTIVE_TABLE=;LVM2_LV_DEVICE_OPEN=open;LVM2_CACHE_TOTAL_BLOCKS=;LVM2_CACHE_USED_BLOCKS=;LVM2_CACHE_DIRTY_BLOCKS=;LVM2_CACHE_READ_HITS=;LVM2_CACHE_READ_MISSES=;LVM2_CACHE_WRITE_HITS=;LVM2_CACHE_WRITE_MISSES=;LVM2_LV_HEALTH_STATUS=;LVM2_KERNEL_DISCARDS=;LVM2_VG_FMT=lvm2;LVM2_VG_UUID=3UVZM0-42jt-qlbl-FGUH-XhD0-n2IL-D5b19F;LVM2_VG_NAME=vg0;LVM2_VG_ATTR=wz--n-;LVM2_VG_PERMISSIONS=writeable;LVM2_VG_EXTENDABLE=extendable;LVM2_VG_EXPORTED=;LVM2_VG_PARTIAL=;LVM2_VG_ALLOCATION_POLICY=normal;LVM2_VG_CLUSTERED=;LVM2_VG_SIZE=999938850816;LVM2_VG_FREE=149795373056;LVM2_VG_SYSID=;LVM2_VG_SYSTEMID=;LVM2_VG_LOCKTYPE=;LVM2_VG_LOCKARGS=;LVM2_VG_EXTENT_SIZE=4194304;LVM2_VG_EXTENT_COUNT=238404;LVM2_VG_FREE_COUNT=35714;LVM2_MAX_LV=0;LVM2_MAX_PV=0;LVM2_PV_COUNT=1;LVM2_VG_MISSING_PV_COUNT=0;LVM2_LV_COUNT=11;LVM2_SNAP_COUNT=0;LVM2_VG_SEQNO=20;LVM2_VG_TAGS=;LVM2_VG_PROFILE=;LVM2_VG_MDA_COUNT=1;LVM2_VG_MDA_USED_COUNT=1;LVM2_VG_MDA_FREE=516608;LVM2_VG_MDA_SIZE=1044480;LVM2_VG_MDA_COPIES=unmanaged
  LVM2_LV_UUID=k1wBOP-zNSf-rjqD-L69D-xUbV-WcId-THkp7i;LVM2_LV_NAME=var;LVM2_LV_FULL_NAME=vg0/var;LVM2_LV_PATH=/dev/vg0/var;LVM2_LV_DM_PATH=/dev/mapper/vg0-var;LVM2_LV_PARENT=;LVM2_LV_ATTR=-wi-a-----;LVM2_LV_LAYOUT=linear;LVM2_LV_ROLE=public;LVM2_LV_INITIAL_IMAGE_SYNC=;LVM2_LV_IMAGE_SYNCED=;LVM2_LV_MERGING=;LVM2_LV_CONVERTING=;LVM2_LV_ALLOCATION_POLICY=inherit;LVM2_LV_ALLOCATION_LOCKED=;LVM2_LV_FIXED_MINOR=;LVM2_LV_MERGE_FAILED=unknown;LVM2_LV_SNAPSHOT_INVALID=unknown;LVM2_LV_SKIP_ACTIVATION=;LVM2_LV_WHEN_FULL=;LVM2_LV_ACTIVE=active;LVM2_LV_ACTIVE_LOCALLY=active locally;LVM2_LV_ACTIVE_REMOTELY=;LVM2_LV_ACTIVE_EXCLUSIVELY=active exclusively;LVM2_LV_MAJOR=-1;LVM2_LV_MINOR=-1;LVM2_LV_READ_AHEAD=auto;LVM2_LV_SIZE=3070230528;LVM2_LV_METADATA_SIZE=;LVM2_SEG_COUNT=2;LVM2_ORIGIN=;LVM2_ORIGIN_UUID=;LVM2_ORIGIN_SIZE=;LVM2_LV_ANCESTORS=;LVM2_LV_DESCENDANTS=;LVM2_DATA_PERCENT=;LVM2_SNAP_PERCENT=;LVM2_METADATA_PERCENT=;LVM2_COPY_PERCENT=;LVM2_SYNC_PERCENT=;LVM2_RAID_MISMATCH_COUNT=;LVM2_RAID_SYNC_ACTION=;LVM2_RAID_WRITE_BEHIND=;LVM2_RAID_MIN_RECOVERY_RATE=;LVM2_RAID_MAX_RECOVERY_RATE=;LVM2_MOVE_PV=;LVM2_MOVE_PV_UUID=;LVM2_CONVERT_LV=;LVM2_CONVERT_LV_UUID=;LVM2_MIRROR_LOG=;LVM2_MIRROR_LOG_UUID=;LVM2_DATA_LV=;LVM2_DATA_LV_UUID=;LVM2_METADATA_LV=;LVM2_METADATA_LV_UUID=;LVM2_POOL_LV=;LVM2_POOL_LV_UUID=;LVM2_LV_TAGS=;LVM2_LV_PROFILE=;LVM2_LV_LOCKARGS=;LVM2_LV_TIME=2013-11-05 16:54:36 +0200;LVM2_LV_HOST=bulldozer;LVM2_LV_MODULES=;LVM2_LV_KERNEL_MAJOR=254;LVM2_LV_KERNEL_MINOR=1;LVM2_LV_KERNEL_READ_AHEAD=131072;LVM2_LV_PERMISSIONS=writeable;LVM2_LV_SUSPENDED=;LVM2_LV_LIVE_TABLE=live table present;LVM2_LV_INACTIVE_TABLE=;LVM2_LV_DEVICE_OPEN=;LVM2_CACHE_TOTAL_BLOCKS=;LVM2_CACHE_USED_BLOCKS=;LVM2_CACHE_DIRTY_BLOCKS=;LVM2_CACHE_READ_HITS=;LVM2_CACHE_READ_MISSES=;LVM2_CACHE_WRITE_HITS=;LVM2_CACHE_WRITE_MISSES=;LVM2_LV_HEALTH_STATUS=;LVM2_KERNEL_DISCARDS=;LVM2_VG_FMT=lvm2;LVM2_VG_UUID=3UVZM0-42jt-qlbl-FGUH-XhD0-n2IL-D5b19F;LVM2_VG_NAME=vg0;LVM2_VG_ATTR=wz--n-;LVM2_VG_PERMISSIONS=writeable;LVM2_VG_EXTENDABLE=extendable;LVM2_VG_EXPORTED=;LVM2_VG_PARTIAL=;LVM2_VG_ALLOCATION_POLICY=normal;LVM2_VG_CLUSTERED=;LVM2_VG_SIZE=999938850816;LVM2_VG_FREE=149795373056;LVM2_VG_SYSID=;LVM2_VG_SYSTEMID=;LVM2_VG_LOCKTYPE=;LVM2_VG_LOCKARGS=;LVM2_VG_EXTENT_SIZE=4194304;LVM2_VG_EXTENT_COUNT=238404;LVM2_VG_FREE_COUNT=35714;LVM2_MAX_LV=0;LVM2_MAX_PV=0;LVM2_PV_COUNT=1;LVM2_VG_MISSING_PV_COUNT=0;LVM2_LV_COUNT=11;LVM2_SNAP_COUNT=0;LVM2_VG_SEQNO=20;LVM2_VG_TAGS=;LVM2_VG_PROFILE=;LVM2_VG_MDA_COUNT=1;LVM2_VG_MDA_USED_COUNT=1;LVM2_VG_MDA_FREE=516608;LVM2_VG_MDA_SIZE=1044480;LVM2_VG_MDA_COPIES=unmanaged
  LVM2_LV_UUID=ScocFS-DUGG-x6Mn-f8F2-nPLj-Ree3-M56uzA;LVM2_LV_NAME=video;LVM2_LV_FULL_NAME=vg0/video;LVM2_LV_PATH=/dev/vg0/video;LVM2_LV_DM_PATH=/dev/mapper/vg0-video;LVM2_LV_PARENT=;LVM2_LV_ATTR=-wi-ao----;LVM2_LV_LAYOUT=linear;LVM2_LV_ROLE=public;LVM2_LV_INITIAL_IMAGE_SYNC=;LVM2_LV_IMAGE_SYNCED=;LVM2_LV_MERGING=;LVM2_LV_CONVERTING=;LVM2_LV_ALLOCATION_POLICY=inherit;LVM2_LV_ALLOCATION_LOCKED=;LVM2_LV_FIXED_MINOR=;LVM2_LV_MERGE_FAILED=unknown;LVM2_LV_SNAPSHOT_INVALID=unknown;LVM2_LV_SKIP_ACTIVATION=;LVM2_LV_WHEN_FULL=;LVM2_LV_ACTIVE=active;LVM2_LV_ACTIVE_LOCALLY=active locally;LVM2_LV_ACTIVE_REMOTELY=;LVM2_LV_ACTIVE_EXCLUSIVELY=active exclusively;LVM2_LV_MAJOR=-1;LVM2_LV_MINOR=-1;LVM2_LV_READ_AHEAD=auto;LVM2_LV_SIZE=268435456000;LVM2_LV_METADATA_SIZE=;LVM2_SEG_COUNT=2;LVM2_ORIGIN=;LVM2_ORIGIN_UUID=;LVM2_ORIGIN_SIZE=;LVM2_LV_ANCESTORS=;LVM2_LV_DESCENDANTS=;LVM2_DATA_PERCENT=;LVM2_SNAP_PERCENT=;LVM2_METADATA_PERCENT=;LVM2_COPY_PERCENT=;LVM2_SYNC_PERCENT=;LVM2_RAID_MISMATCH_COUNT=;LVM2_RAID_SYNC_ACTION=;LVM2_RAID_WRITE_BEHIND=;LVM2_RAID_MIN_RECOVERY_RATE=;LVM2_RAID_MAX_RECOVERY_RATE=;LVM2_MOVE_PV=;LVM2_MOVE_PV_UUID=;LVM2_CONVERT_LV=;LVM2_CONVERT_LV_UUID=;LVM2_MIRROR_LOG=;LVM2_MIRROR_LOG_UUID=;LVM2_DATA_LV=;LVM2_DATA_LV_UUID=;LVM2_METADATA_LV=;LVM2_METADATA_LV_UUID=;LVM2_POOL_LV=;LVM2_POOL_LV_UUID=;LVM2_LV_TAGS=;LVM2_LV_PROFILE=;LVM2_LV_LOCKARGS=;LVM2_LV_TIME=2013-11-06 00:54:48 +0200;LVM2_LV_HOST=bulldozer;LVM2_LV_MODULES=;LVM2_LV_KERNEL_MAJOR=254;LVM2_LV_KERNEL_MINOR=5;LVM2_LV_KERNEL_READ_AHEAD=131072;LVM2_LV_PERMISSIONS=writeable;LVM2_LV_SUSPENDED=;LVM2_LV_LIVE_TABLE=live table present;LVM2_LV_INACTIVE_TABLE=;LVM2_LV_DEVICE_OPEN=open;LVM2_CACHE_TOTAL_BLOCKS=;LVM2_CACHE_USED_BLOCKS=;LVM2_CACHE_DIRTY_BLOCKS=;LVM2_CACHE_READ_HITS=;LVM2_CACHE_READ_MISSES=;LVM2_CACHE_WRITE_HITS=;LVM2_CACHE_WRITE_MISSES=;LVM2_LV_HEALTH_STATUS=;LVM2_KERNEL_DISCARDS=;LVM2_VG_FMT=lvm2;LVM2_VG_UUID=3UVZM0-42jt-qlbl-FGUH-XhD0-n2IL-D5b19F;LVM2_VG_NAME=vg0;LVM2_VG_ATTR=wz--n-;LVM2_VG_PERMISSIONS=writeable;LVM2_VG_EXTENDABLE=extendable;LVM2_VG_EXPORTED=;LVM2_VG_PARTIAL=;LVM2_VG_ALLOCATION_POLICY=normal;LVM2_VG_CLUSTERED=;LVM2_VG_SIZE=999938850816;LVM2_VG_FREE=149795373056;LVM2_VG_SYSID=;LVM2_VG_SYSTEMID=;LVM2_VG_LOCKTYPE=;LVM2_VG_LOCKARGS=;LVM2_VG_EXTENT_SIZE=4194304;LVM2_VG_EXTENT_COUNT=238404;LVM2_VG_FREE_COUNT=35714;LVM2_MAX_LV=0;LVM2_MAX_PV=0;LVM2_PV_COUNT=1;LVM2_VG_MISSING_PV_COUNT=0;LVM2_LV_COUNT=11;LVM2_SNAP_COUNT=0;LVM2_VG_SEQNO=20;LVM2_VG_TAGS=;LVM2_VG_PROFILE=;LVM2_VG_MDA_COUNT=1;LVM2_VG_MDA_USED_COUNT=1;LVM2_VG_MDA_FREE=516608;LVM2_VG_MDA_SIZE=1044480;LVM2_VG_MDA_COPIES=unmanaged`

func TestQueryPhysicalVolumes(t *testing.T) {
	e := &MockExecutor{}
	lvm := &lowlevel.LVM{Backend: e}
	e.On("Read", "pvs", []string{"--nameprefix", "--noheadings", "--unquoted", "--units", "b", "-o", "pv_all,vg_name", "--separator", ";"}).Return(TESTDATA_PVS, nil)
	pvs, err := lvm.QueryPhysicalVolumes()
	require.NoError(t, err)
	require.Contains(t, pvs, "/dev/md127")
	pv := pvs["/dev/md127"]
	assert.Equal(t, "/dev/md127", pv.Name)
	assert.Equal(t, "vg0", pv.Group)
	assert.Equal(t, "/dev/md127", pv.Device)
}

func TestQueryVolumeGroups(t *testing.T) {
	e := &MockExecutor{}
	lvm := &lowlevel.LVM{Backend: e}
	e.On("Read", "vgs", []string{"--nameprefix", "--noheadings", "--unquoted", "--units", "b", "-o", "all", "--separator", ";"}).Return(TESTDATA_PVS, nil)
	vgs, err := lvm.QueryVolumeGroups()
	require.NoError(t, err)
	require.Contains(t, vgs, "vg0")
}

func TestQueryLogicalVolume(t *testing.T) {
	e := &MockExecutor{}
	lvm := &lowlevel.LVM{Backend: e}
	e.On("Read", "lvs", []string{"--nameprefix", "--noheadings", "--unquoted", "--units", "b", "-o", "all", "--separator", ";", "vg0"}).Return(TESTDATA_LVS, nil)
	lvs, err := lvm.QueryLogicalVolumes("vg0")
	require.NoError(t, err)
	require.Contains(t, lvs, "data")
}
